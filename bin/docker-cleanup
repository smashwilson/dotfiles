#!/bin/bash
#
# Stop and remove either a single docker container or all docker containers.

set -euo pipefail
IFS=$'\n\r'

DOCKER='sudo docker'
which boot2docker >/dev/null 2>&1 && DOCKER='docker'

CONTAINER=${1-}

if [ -n "${CONTAINER}" ]; then
  echo "Cleaning container ${CONTAINER}."

  ${DOCKER} stop ${CONTAINER}
  ${DOCKER} rm ${CONTAINER}
else
  echo "Cleaning all containers."

  RUNNING=$(${DOCKER} ps -q)
  [ -n "${RUNNING}" ] && ${DOCKER} stop ${RUNNING}

  ALL=$(${DOCKER} ps -qa)
  [ -n "${ALL}" ] && ${DOCKER} rm ${ALL}
fi
