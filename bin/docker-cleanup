#!/bin/bash
#
# Stop and remove either a single docker container or all docker containers.

set -euo pipefail
IFS=$'\n\r'

SUDO='sudo'
which boot2docker >/dev/null 2>&1 && SUDO=''

CONTAINER=${1-}

if [ -n "${CONTAINER}" ]; then
  echo "Cleaning container ${CONTAINER}."

  ${SUDO} docker stop ${CONTAINER}
  ${SUDO} docker rm ${CONTAINER}
else
  echo "Cleaning all containers."

  RUNNING=$(${SUDO} docker ps -q)
  [ -n "${RUNNING}" ] && ${SUDO} docker stop ${RUNNING}

  ALL=$(${SUDO} docker ps -qa)
  [ -n "${ALL}" ] && ${SUDO} docker rm ${ALL}
fi
