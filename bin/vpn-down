#!/bin/bash
#
# Disconnect from the VPN, if connected.

sudo kill -SIGINT $(cat ${HOME}/.openconnect.pid)

sleep 3

if [[ -e /etc/resolv.conf.vpn-up.bak ]]
then
    echo "Restoring /etc/resolv.conf..."
    sudo cp /etc/resolv.conf{.vpn-up.bak,}
    sudo rm /etc/resolv.conf.vpn-up.bak
else
    echo "No backup of /etc/resolv.conf; skipping"
fi

if [[ -e /etc/hosts.vpn-up.bak ]]
then
    echo "Restoring /etc/hosts..."
    sudo cp /etc/hosts{.vpn-up.bak,}
    sudo rm /etc/hosts.vpn-up.bak
else
    echo "No backup of /etc/hosts; skipping"
fi

exit 0
