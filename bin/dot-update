#!/bin/bash
#
# Quickly update some or all of the contents of this repository.

cd ${DOT}

dotfiles()
{
  if [ $(git rev-parse --symbolic-full-name HEAD) = "refs/heads/master" ]; then
    git fetch origin
    git merge --ff-only origin/master
  else
    echo "not updating .dotfiles: currently on non-master branch"
    exit 1
  fi
}

ansible()
{
  local ARGS=$1

  exec ansible-playbook -i localhost, ${DOT}/script/ansible/site.yml ${ARGS}
  # --ask-sudo-pass
}

if [ $# = "0" ]; then
  dotfiles
else
  for ARG in $*; do
    case ${ARG} in
      ruby|python|nodejs|go|rust)
        echo "Updating: ${ARG}"
        ansible "--tags ${ARG} --ask-sudo-pass"
        ;;
      *)
        echo "Unrecognized component: ${ARG}"
        exit 1
        ;;
    esac
  done
fi
